# 李洋的计算物理笔记

# 课堂知识

## 整体内容
* 数值计算的基本观念
* 数值计算方法
* 数值算法(模拟)
* 应用

## 第一章:数值计算的基本观念
### 第一节.浮点数的储存
---
 ***例1.1 浮点数求和数据的储存***
```c
#include<stdio.h>

int main(void){
  float sum = 0;

  for(int i=0; i<10000; i++){
    sum += 0.0001;
  }
  printf("sum = %f", sum);
  return 0;
}
```
*执行上述代码所得结果为*
```
sum = 1.000054
```
*由此可见, 加和过程中确实存在误差, 结果并不严格为1.0000*

***例1.2 一元二次方程***   
*一般的,求解一元二次方程的公式有:*

$$x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}$$

*对于一元二次方程:*

$$x^2-(10^{17}+1)x+1=0$$

*在计算机编程中应用前文所述的一元二次方程求解通式求解,其结果为:*  
```
x1 = 10^17
x2 = 0
```
*然而, 实际上, 对上述一元二次方程进行因式分解不难得到, 其正确的解应为:*

$$x_1 = 10^{17}$$
$$x_2 = 1$$

 *$x^2$求解值与实际值相差太大以至于我们不能忽略, 而出现这种情况的原因是两个十分相近的数相减.*      
*对于这一原因, 我们将在下面正文中做更加具体的分析.*

---

#### 二进制与十进制

* 计算机中所有的数都要转化为二进制数进行运算
* 转化细节:  
    1. 整数间可以进行不丢失任何信息的转化
    2. 十进制小数与二进制小数间存在丢失信息的转化:  
       1) 循环十进制小数其二进制仍是循环小数
       2) 不循环十进制小数其二进制可能循环(eg. 0.1)

#### 浮点数和规格化浮点数
$$Float = S \times F \times 2^E$$
上述公式中各个符号的意义如下  
|Float|S|F|2|E|
|---|---|---|---|---|---|
|浮点数|符号|尾数|底数|指数|
由上述公式不难得出, 对于同一个数, 可以存在多个不同的表示方法. 具体的, 只需同时改变一个浮点数的尾数和指数, 就可以得到相同的浮点数. 因此, 制定一种约定, 将一个浮点数的表示方法确定下来是十分必要的. 这种约定在确定一个浮点数表示方法的同时, 也应尽可能使其所占空间最小, 表示数值范围最大. 在这种思想下诞生的一种浮点数形式被称为 '规格化浮点数'.

规格化浮点数的定义十分简单: **对于一个规格化浮点数, 其F(尾数)应落在[0.1, 1.0)中**.
更清晰的:
浮点数在计算机中储存的形式如下图所示.
<div align=center><img src="image/S9_float_point.png"/></div>

#### 机器精度
* 定义: 若一个最小的浮点数加上浮点数1.0后, 可以产生一个不同于1.0的浮点数, 则称, 次最小浮点数为机器精度.  
即满足$1.0 + \varepsilon > 1.0$  
其中 $\frac{\varepsilon}{2}$对应于浮点数尾数(F)的最小精度变化$\varepsilon_F$
---
*对上述$\varepsilon_F$定义的理解如下:*  
*不同浮点数进行加法运算时首先要进行对阶操作, 对阶过后, $\varepsilon$的数值变为:*

$$\varepsilon = F_\varepsilon \times 2^1$$
*从而*

$$F_\varepsilon = \frac{\varepsilon}{2}$$

---
尾数的精度 $F_\varepsilon$ 在之后的相对误差计算中是起到关键作用的.

---
*一台计算机的机器精度由下列代码得到*
```c
#include<stdio.h>

int main(void){
  float eps = 1.0;

  do{
    eps *= 0.5;
    printf("%e\n", eps);
  }while(1.0<1.0+eps);

  return 0;
}
```
 *上述程序在Macbook2017 版的 MacOS上运行的结果为:*
 ```
 5.000000e-01
2.500000e-01
1.250000e-01
6.250000e-02
3.125000e-02
1.562500e-02
7.812500e-03
3.906250e-03
1.953125e-03
9.765625e-04
4.882812e-04
2.441406e-04
1.220703e-04
6.103516e-05
3.051758e-05
1.525879e-05
7.629395e-06
3.814697e-06
1.907349e-06
9.536743e-07
4.768372e-07
2.384186e-07
1.192093e-07
5.960464e-08
2.980232e-08
1.490116e-08
7.450581e-09
3.725290e-09
1.862645e-09
9.313226e-10
4.656613e-10
2.328306e-10
1.164153e-10
5.820766e-11
2.910383e-11
1.455192e-11
7.275958e-12
3.637979e-12
1.818989e-12
9.094947e-13
4.547474e-13
2.273737e-13
1.136868e-13
5.684342e-14
2.842171e-14
1.421085e-14
7.105427e-15
3.552714e-15
1.776357e-15
8.881784e-16
4.440892e-16
2.220446e-16
1.110223e-16
 ``` 
 *可见这台机器的机器精度为$1.110223e{-16}$*

----
* 浮点误差  
相对误差公式:

$$\delta = \frac{(F+F_\varepsilon)\times 2^E-F\times 2^E}{F\times 2^E} = \frac{\varepsilon}{2F}$$
其中 $A<1.0$

因此,进一步的:

$$\delta > \frac{\varepsilon}{2}$$

#### 浮点数的运算
* 加法/减法  
对阶(指数调同), 应防止大数吃小数

* 乘法  
存在误差

#### 数值计算的误差
* 舍入误差: 由于计算机存储字节数有限引起的误差  
  来源:  
  + 实数转化为浮点数
  + 浮点运算

* 截断误差: 数值计算是,采用数值计算方法得到的近似值与准确值之间的差异(也称为方法误差)

### 第二节:舍入误差的传播

#### 运算规则
*  加法\减法

$$\dot{a} = a  + \varepsilon_a$$

$$\dot{b} = b  + \varepsilon_b$$
$$\dot{a} \pm \dot{b} = a \pm b + (\varepsilon_a \pm \varepsilon_b)$$

* 乘法

$$\dot{a} \dot{b} = ab + a\varepsilon_b + b\varepsilon_a + \varepsilon_a\varepsilon_b$$
$$\dot{a} \dot{b} \approx ab + a\varepsilon_b + b\varepsilon_a $$
相对误差:

$$\delta = \frac{\dot{a} \dot{b}-ab}{ab} = \frac{\varepsilon_a}{a}+\frac{\varepsilon_b}{b}$$

* 除法

$$\frac{\dot{a}}{\dot{b}} = \frac{\varepsilon_a+a}{\varepsilon_b+b} =(a+\varepsilon_a)(\frac{1}{b}-\frac{\varepsilon_a}{b^2}+...)=\frac{a}{b}+\frac{\varepsilon_a}{b}+\frac{a\varepsilon_b}{b^2}$$

相对误差:

$$\delta = \frac{\frac{\dot{a}}{\dot{b}}-\frac{a}{b}}{\frac{a}{b}} = \frac{\varepsilon_a}{a}-\frac{\varepsilon_b}{b}$$$$

* 函数

$$f(\dot{a}) = f(a+\varepsilon_a)$$
$$\Delta f = f(a+\varepsilon_a)-f(a)$$
$$ \Delta f= f'(a)\varepsilon_a \approx f'(\dot{a})\varepsilon_a$$
可见,   
当$f'(\dot{a})$大于1时, 误差放大.  
当$f'(\dot{a})$小于1时, 误差缩小.

#### 防止舍入误差

* 避免大数吃小数  
处理方法: 变化公式

* 避免两个相近的数相减  
处理方法:  
   + 多保留有效数字
   + 变换公式  
---
 *例1.3 当 $x>>1$ 时,求*

$$S = \sqrt{x+1}-\sqrt{x}$$
*解:*  
*对上式进行变换,得:*

$$S = \frac{(\sqrt{x+1}-\sqrt{x})(\sqrt{x+1}+\sqrt{x})}{\sqrt{x+1}+\sqrt{x}}$$
*化简得:*

$$S = \frac{1}{\sqrt{x+1}+\sqrt{x}}$$

*至此,成功解决了两个接近的数相减的问题*

---

* 除法${\dot{a}}/{\dot{b}}$中, 避免出现 $|a|>>|b|$的情况.

$$\frac{\dot{a}}{\dot{b}}-\frac{a}{b} =\frac{\varepsilon_a b - \varepsilon_b a}{b^2} \approx -\frac{a}{b}\cdot
\frac{\varepsilon_b}{b}$$

因此$|{a}/{b}|$不能过大, 也即, 应避免出现 $|a|>>|b|$的情况.

### 第三节.算法的准确性和稳定性

#### 算法的准确性
选择合适的算法,计算结果更可靠.
#### 算法的稳定性
防止方法误差

---
例1.4 积分的迭代算法

计算积分:

$$I_n = \int_{0}^{1} \frac{x^n}{x+5} dx$$

*解:*
*利用递推公式:*

$$I_n = $$
---







# 自学内容

# 附录